<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Emergency Operations Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Segoe UI,Arial;background:#001f3f;color:white;}
.header{position:sticky;top:0;background:#00264d;padding:10px 15px;display:flex;align-items:center;justify-content:space-between;border-bottom:2px solid #004080;flex-wrap:wrap;}
.header h1{margin:0;font-size:20px;}
.header button{margin-left:10px;margin-top:5px;}
#clock{font-weight:bold;margin-top:5px;}

.container{display:flex;height:calc(100vh - 60px);}
.sidebar{width:220px;background:#00264d;display:flex;flex-direction:column;flex-shrink:0;}
.sidebar button{padding:14px;border:none;background:none;color:white;text-align:left;cursor:pointer;border-bottom:1px solid #004080;font-size:16px;}
.sidebar button:hover{background:#004080;}

.main{flex:1;padding:15px;overflow-y:auto;}
section{display:none;}
section.active{display:block;}
.card{background:#003366;padding:12px;border-radius:10px;margin:8px 0;}
.status-btn{padding:8px 10px;border:none;border-radius:4px;margin:3px;color:white;cursor:pointer;font-size:14px;}
.Responding{background:orange;} .Busy{background:blue;} .StandingOff{background:red;} .Completed{background:green;}
.timer{font-size:16px;font-weight:bold;padding:4px 6px;border-radius:6px;}
.incident-desc{color:#8B0000;font-weight:bold;}
.map-link{display:inline-block;background:#0074D9;color:white;padding:4px 8px;border-radius:4px;text-decoration:none;margin-top:4px;}
.map-link:hover{background:#005fa3;}

/* INPUTS AND BUTTONS FULL WIDTH ON MOBILE */
input, select, textarea, button.action{width:100%;box-sizing:border-box;margin:5px 0;font-size:16px;padding:8px;}
button.action{border-radius:5px;cursor:pointer;}

/* RESPONSIVE LAYOUT */
@media (max-width: 768px) {
  .container{flex-direction:column;}
  .sidebar{width:100%;flex-direction:row;overflow-x:auto;}
  .sidebar button{flex:1;white-space:nowrap;font-size:14px;padding:10px;}
  .main{padding:10px;}
}
</style>
</head>

<body>

<div class="header">
<h1>Emergency Operations Dashboard</h1>
<div id="clock"></div>
<button onclick="toggleTheme()">ðŸŒ— Theme</button>
</div>

<div class="container">
<div class="sidebar">
<button onclick="show('addIncident')">Add Incident</button>
<button onclick="show('activeIncidents')">Active Incidents</button>
<button onclick="show('completedIncidents')">Completed Incidents</button>
</div>

<div class="main">

<!-- Add Incident Section -->
<section id="addIncident">
<h2>Create Incident</h2>
<input id="address" placeholder="Address">
<input id="description" placeholder="Description">
<select id="priority">
<option>Low</option><option>Medium</option>
<option>High</option><option>Critical</option>
</select>
<input id="cos" placeholder="Contact On Scene">
<button class="action" onclick="addIncident()">Add Incident</button>
</section>

<!-- Active Incidents -->
<section id="activeIncidents">
<h2>Active Incidents</h2>
<div id="incidentList"></div>
</section>

<!-- Completed Incidents -->
<section id="completedIncidents">
<h2>Completed Incidents</h2>
<div id="completedList"></div>
</section>

</div>
</div>

<script>
let incidents = [];
let completedIncidents = [];

// Show section
function show(id){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// Clock
function updateClock(){
  const now = new Date();
  document.getElementById("clock").textContent = now.toLocaleString();
}
setInterval(updateClock,1000);
updateClock();

// Theme toggle
function toggleTheme(){
  document.body.classList.toggle("light");
}

// Add Incident
function addIncident(){
  const address = document.getElementById("address").value;
  const desc = document.getElementById("description").value;
  const priority = document.getElementById("priority").value;
  const cos = document.getElementById("cos").value;
  if(!address || !desc || !priority || !cos){alert("Fill all fields"); return;}
  
  const incident = {
    id: Date.now(),
    address, description: desc,
    priority, cos,
    status: "Responding",
    start: Date.now(),
    elapsed: 0
  };
  incidents.unshift(incident); // newest first
  renderIncidents();
  document.getElementById("address").value="";
  document.getElementById("description").value="";
  document.getElementById("priority").value="Low";
  document.getElementById("cos").value="";
}

// Render Active Incidents
function renderIncidents(){
  const container = document.getElementById("incidentList");
  container.innerHTML="";
  incidents.forEach(i=>{
    const t = i.status==="StandingOff"||i.status==="Completed"?i.elapsed:i.elapsed+(Date.now()-i.start);
    const c = document.createElement("div");
    c.className="card";
    c.innerHTML=`
      <b>${i.address}</b><br>
      <span class="incident-desc">${i.description}</span><br>
      Priority: ${i.priority}<br>
      COS: ${i.cos}<br>
      <span class="timer ${i.status}">${new Date(t).toISOString().substr(11,8)}</span><br>
      <a class="map-link" target="_blank" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(i.address)}">Open Map</a><br>
      <button class="status-btn Responding" onclick="updateStatus(${i.id},'Responding')">Responding</button>
      <button class="status-btn Busy" onclick="updateStatus(${i.id},'Busy')">Busy</button>
      <button class="status-btn StandingOff" onclick="updateStatus(${i.id},'StandingOff')">Standing Off</button>
      <button class="status-btn Completed" onclick="updateStatus(${i.id},'Completed')">Completed</button>
      <button class="status-btn Completed" onclick="closeIncident(${i.id})">Close Incident</button>
    `;
    container.appendChild(c);
  });
  renderCompleted();
}

// Update status
function updateStatus(id,status){
  const i = incidents.find(x=>x.id===id);
  if(!i) return;
  if(status==="StandingOff" || status==="Completed"){
    i.elapsed += Date.now()-i.start;
  }
  i.status=status;
  if(status!=="Completed") i.start = Date.now();
  renderIncidents();
}

// Close Incident
function closeIncident(id){
  const idx = incidents.findIndex(x=>x.id===id);
  if(idx>-1){
    const [i] = incidents.splice(idx,1);
    i.status="Completed";
    i.elapsed += Date.now()-i.start;
    completedIncidents.unshift(i);
    renderIncidents();
  }
}

// Render Completed
function renderCompleted(){
  const container = document.getElementById("completedList");
  container.innerHTML="";
  completedIncidents.forEach(i=>{
    const c = document.createElement("div");
    c.className="card Completed";
    c.innerHTML=`
      <b>${i.address}</b><br>
      <span class="incident-desc">${i.description}</span><br>
      Priority: ${i.priority}<br>
      COS: ${i.cos}<br>
      Time: ${new Date(i.elapsed).toISOString().substr(11,8)}<br>
      <a class="map-link" target="_blank" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(i.address)}">Open Map</a>
    `;
    container.appendChild(c);
  });
}

// Initial render
show('addIncident');
renderIncidents();
</script>

</body>
</html>
