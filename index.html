<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Live Dispatch System</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Segoe UI;background:#0b1e35;color:white}
header{background:#132c4d;padding:15px;font-size:20px}
.container{display:flex;height:100vh}
.sidebar{width:250px;background:#132c4d;padding:10px}
.sidebar button{width:100%;margin:5px 0;padding:10px;background:#1f3f66;border:none;color:white;cursor:pointer}
.sidebar button:hover{background:#29598f}
.main{flex:1;padding:20px;overflow:auto}
.card{background:#1f3f66;padding:12px;margin:10px 0;border-radius:6px}
select,input{width:100%;padding:6px;margin:4px 0}
button.action{background:#0074D9;color:white;border:none;padding:8px;margin-top:6px;cursor:pointer}
.status{font-weight:bold}
.available{color:#2ecc71}
.enroute{color:#f1c40f}
.onscene{color:#e67e22}
.busy{color:#e74c3c}
</style>
</head>

<body>

<header>ðŸ”¥ Live Emergency Dispatch</header>

<div class="container">

<div class="sidebar">
<button onclick="show('login')">Sign In</button>
<button onclick="show('units')">Units</button>
<button onclick="show('incidents')">Incidents</button>
</div>

<div class="main">

<section id="login">
<h2>Sign In</h2>
<input id="name" placeholder="Name">
<input id="registration" placeholder="Unit Registration">
<select id="role">
<option value="Responder">Responder</option>
<option value="Dispatcher">Dispatcher</option>
</select>
<button class="action" onclick="signIn()">Sign In</button>
</section>

<section id="units" style="display:none">
<h2>Active Units</h2>
<div id="unitList"></div>
</section>

<section id="incidents" style="display:none">
<h2>Create Incident</h2>
<input id="address" placeholder="Address">
<select id="priority">
<option>Low</option>
<option>Medium</option>
<option>High</option>
<option>Critical</option>
</select>
<button class="action" onclick="createIncident()">Create Incident</button>

<h3>Active Incidents</h3>
<div id="incidentList"></div>
</section>

</div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, updateDoc, doc } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

/* ðŸ”´ PASTE YOUR FIREBASE CONFIG BELOW */
const firebaseConfig = {
  apiKey: "PASTE_HERE",
  authDomain: "PASTE_HERE",
  projectId: "PASTE_HERE",
  storageBucket: "PASTE_HERE",
  messagingSenderId: "PASTE_HERE",
  appId: "PASTE_HERE"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let currentUser=null;

window.show = function(id){
document.querySelectorAll("section").forEach(s=>s.style.display="none");
document.getElementById(id).style.display="block";
}

/* SIGN IN */
window.signIn = async function(){
currentUser={
name: name.value,
registration: registration.value,
role: role.value,
status:"Available"
};

await addDoc(collection(db,"units"),currentUser);
show("units");
}

/* CREATE INCIDENT */
window.createIncident = async function(){
if(currentUser.role!=="Dispatcher"){
alert("Dispatcher only");
return;
}

await addDoc(collection(db,"incidents"),{
address: address.value,
priority: priority.value,
status:"Waiting",
assigned:null
});
}

/* REALTIME UNITS */
onSnapshot(collection(db,"units"), snapshot=>{
const div=document.getElementById("unitList");
div.innerHTML="";
snapshot.forEach(docSnap=>{
const u=docSnap.data();
div.innerHTML+=`
<div class="card">
<b>${u.name}</b> (${u.registration})<br>
Status: ${u.status}
</div>`;
});
});

/* REALTIME INCIDENTS */
onSnapshot(collection(db,"incidents"), snapshot=>{
const div=document.getElementById("incidentList");
div.innerHTML="";
snapshot.forEach(docSnap=>{
const i=docSnap.data();
div.innerHTML+=`
<div class="card">
<b>${i.address}</b> - ${i.priority}<br>
Status: ${i.status}
</div>`;
});
});

show("login");

</script>

</body>
</html>
