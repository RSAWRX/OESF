<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Emergency Operations Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
--bg:#001f3f;--panel:#00264d;--card:#003366;--text:white;
}
body{margin:0;font-family:Segoe UI,Arial;background:var(--bg);color:var(--text);}
.light{--bg:#f4f6f8;--panel:#fff;--card:#e9ecef;--text:#000;}

.header{
position:sticky;top:0;background:var(--panel);
padding:12px 20px;display:flex;align-items:center;
border-bottom:2px solid #004080;z-index:100;
}
.header h1{margin:0;font-size:22px;}
.header button{margin-left:auto;}

.container{display:flex;height:calc(100vh - 60px);}
.sidebar{
width:240px;background:var(--panel);display:flex;flex-direction:column;
}
.sidebar button{
padding:16px;border:none;background:none;color:inherit;
text-align:left;font-size:16px;cursor:pointer;
border-bottom:1px solid #004080;
}
.sidebar button:hover{background:#004080;}

.main{flex:1;padding:20px;overflow-y:auto;}
section{display:none;}
section.active{display:block;}

.card{
background:var(--card);padding:14px;border-radius:10px;margin:10px 0;
}
.completed{opacity:0.5;}

input,select,textarea{
width:100%;padding:8px;margin:6px 0;border-radius:4px;border:none;
}

button.action{
padding:10px 14px;background:#0074D9;color:white;
border:none;border-radius:5px;cursor:pointer;
}
button.action:hover{background:#005fa3;}

.status-btn{
padding:6px 10px;border:none;border-radius:4px;margin:4px 2px;
color:white;cursor:pointer;
}
.Responding{background:orange;}
.InProgress{background:#0074D9;}
.StandingOff{background:red;}
.Completed{background:green;}

.timer{
font-size:22px;font-weight:bold;padding:4px 8px;border-radius:6px;
display:inline-block;margin:6px 0;
}

.pr-Low{background:#2ecc71;padding:4px;border-radius:4px;}
.pr-Medium{background:#f1c40f;color:black;padding:4px;border-radius:4px;}
.pr-High{background:#e67e22;padding:4px;border-radius:4px;}
.pr-Critical{background:#e74c3c;padding:4px;border-radius:4px;}

textarea{min-height:80px;}
a{color:#66b3ff;}
</style>
</head>

<body>

<div class="header">
<h1>Emergency Operations Dashboard</h1>
<button onclick="toggleTheme()">ðŸŒ— Theme</button>
</div>

<div class="container">

<div class="sidebar">
<button onclick="show('login')">Sign In</button>
<button onclick="show('incidents')">Active Incidents</button>
<button onclick="show('reports')">Incident Reports</button>
</div>

<div class="main">

<section id="login">
<h2>Responder Sign In</h2>
<input id="responderName" placeholder="Name">
<select id="role">
<option value="Responder">Responder</option>
<option value="Admin">Admin</option>
</select>
<button class="action" onclick="signIn()">Sign In</button>
</section>

<section id="incidents">
<h2>Active Incidents</h2>

<input id="address" placeholder="Incident Address">

<select id="incidentType">
<option value="Crime">Crime</option>
<option value="Fire">Fire</option>
<option value="Medical">Medical</option>
</select>

<select id="priority">
<option>Low</option>
<option>Medium</option>
<option>High</option>
<option>Critical</option>
</select>

<input id="cos" placeholder="Contact On Scene (COS)">

<button class="action" onclick="addIncident()">Create Incident</button>

<hr>

<div id="incidentList"></div>
</section>

<section id="reports">
<h2>Incident Reports</h2>
<div id="reportList"></div>
</section>

</div>
</div>

<audio id="crimeSound" src="https://www.soundjay.com/button/beep-07.wav"></audio>
<audio id="fireSound" src="https://www.soundjay.com/transport/fire-truck-horn.wav"></audio>
<audio id="medicalSound" src="https://www.soundjay.com/button/beep-09.wav"></audio>

<script>
let currentUser={};
function show(id){
document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

function save(k,v){localStorage.setItem(k,JSON.stringify(v));}
function load(k){return JSON.parse(localStorage.getItem(k))||[];}

function toggleTheme(){
document.body.classList.toggle("light");
localStorage.setItem("theme",document.body.classList.contains("light")?"light":"dark");
}
if(localStorage.getItem("theme")==="light")document.body.classList.add("light");

function signIn(){
currentUser={name:responderName.value,role:role.value};
save("user",currentUser);
show("incidents");
}

function playSound(type){
if(type==="Crime")crimeSound.play();
if(type==="Fire")fireSound.play();
if(type==="Medical")medicalSound.play();
}

function addIncident(){
const incident={
id:Date.now(),
address:address.value,
type:incidentType.value,
priority:priority.value,
cos:cos.value,
status:"Responding",
start:Date.now(),
elapsed:0,
report:""
};
const list=load("incidents");
list.push(incident);
save("incidents",list);
playSound(incident.type);
renderIncidents();
}

function updateStatus(id,status){
const list=load("incidents");
const i=list.find(x=>x.id===id);

if(status==="Completed" && currentUser.role!=="Admin"){
alert("Admin confirmation required");
return;
}
if(status==="Completed" && !confirm("Confirm incident completed?"))return;

if(i.status!=="StandingOff")i.elapsed+=Date.now()-i.start;
i.status=status;
i.start=Date.now();

save("incidents",list);
renderIncidents();
renderReports();
}

function saveReport(id,text){
const list=load("incidents");
list.find(i=>i.id===id).report=text;
save("incidents",list);
renderReports();
}

function renderIncidents(){
incidentList.innerHTML="";
load("incidents").forEach(i=>{
const t=i.status==="StandingOff"?i.elapsed:i.elapsed+(Date.now()-i.start);
const c=document.createElement("div");
c.className="card "+(i.status==="Completed"?"completed":"");
c.innerHTML=`
<b>${i.address}</b><br>
Type: ${i.type} | 
<span class="pr-${i.priority}">${i.priority}</span><br>
COS: ${i.cos}<br>
<span class="timer ${i.status}">${new Date(t).toISOString().substr(11,8)}</span><br>
<a target="_blank" href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(i.address)}">Open Map</a><br>
<button class="status-btn Responding" onclick="updateStatus(${i.id},'Responding')">Responding</button>
<button class="status-btn InProgress" onclick="updateStatus(${i.id},'InProgress')">In Progress</button>
<button class="status-btn StandingOff" onclick="updateStatus(${i.id},'StandingOff')">Standing Off</button>
<button class="status-btn Completed" onclick="updateStatus(${i.id},'Completed')">Completed</button>
<textarea placeholder="Incident Report..." onchange="saveReport(${i.id},this.value)">${i.report||""}</textarea>
`;
incidentList.appendChild(c);
});
}

function renderReports(){
reportList.innerHTML="";
load("incidents").filter(i=>i.status==="Completed").forEach(i=>{
const r=document.createElement("div");
r.className="card";
r.innerHTML=`<b>${i.address}</b><br>${i.report || "No report submitted"}<br>
Time: ${new Date(i.elapsed).toISOString().substr(11,8)}`;
reportList.appendChild(r);
});
}

show("login");
renderIncidents();
renderReports();
</script>

</body>
</html>
